<h1>
<p align="center">项目结构</p>
</h1>

`菖蒲`

<!-- TOC -->

- [BallCC](#ballcc)
    - [BallChange](#ballchange)
    - [BallCollision](#ballcollision)
    - [BallPhysical](#ballphysical)
    - [Npc](#npc)
    - [Player](#player)
        - [CameraController.cs](#cameracontrollercs)
        - [PlayerOnCollisionMethod](#playeroncollisionmethod)
    - [X](#x)
        - [PlayerBallController.cs](#playerballcontrollercs)
        - [PlayerOnCollisionMethod.cs](#playeroncollisionmethodcs)
    - [BallController.cs](#ballcontrollercs)
- [Level](#level)
- [Manager](#manager)
    - [EventManager](#eventmanager)
    - [InputManager](#inputmanager)
    - [SaveManager](#savemanager)
    - [X](#x-1)
        - [LoadManager.cs](#loadmanagercs)
        - [MusicManager.cs](#musicmanagercs)
        - [SubtitleManager.cs](#subtitlemanagercs)
        - [UIManager.cs](#uimanagercs)
- [Panel](#panel)
    - [BallChangePanel.cs](#ballchangepanelcs)
    - [ComicPanel.cs](#comicpanelcs)
    - [ExitPanel.cs](#exitpanelcs)
    - [HintChangePanel.cs](#hintchangepanelcs)
    - [SettingPanel.cs](#settingpanelcs)
    - [SubtitlePanel.cs](#subtitlepanelcs)
- [StaticClass](#staticclass)
- [Tools](#tools)
    - [Core](#core)
        - [ListNodeUtil.cs](#listnodeutilcs)
        - [PanelBase.cs](#panelbasecs)
        - [Singleton.cs](#singletoncs)
        - [TransformUtil.csutil.cs](#transformutilcsutilcs)
- [X](#x-2)
    - [GameStartMono](#gamestartmono)
- [MiniGame(abandon)](#minigameabandon)
- [UI面板](#ui面板)
    - [切球](#切球)
        - [流程](#流程)
        - [BallChangePanel.cs](#ballchangepanelcs-1)
        - [KeyboardFunction.cs](#keyboardfunctioncs)
        - [InputManager.cs](#inputmanagercs)
    - [开场](#开场)
        - [流程](#流程-1)
        - [ComicPanel.cs](#comicpanelcs-1)
    - [退出](#退出)
        - [流程](#流程-2)
        - [ExitPanel.cs](#exitpanelcs-1)
        - [KeyboardFunction.cs](#keyboardfunctioncs-1)
    - [提示切换](#提示切换)
        - [HintChangePanel.cs](#hintchangepanelcs-1)
    - [设置](#设置)
        - [流程](#流程-3)
        - [SettingPanel.cs](#settingpanelcs-1)
    - [字幕](#字幕)
        - [流程](#流程-4)
        - [SubtitlePanel.cs](#subtitlepanelcs-1)
        - [SubtitleManager.cs](#subtitlemanagercs-1)
        - [StaticData.cs](#staticdatacs)

<!-- /TOC -->

<div STYLE="page-break-after: always;"></div>

# BallCC

## BallChange
## BallCollision
## BallPhysical
## Npc
## Player
### CameraController.cs
用于控制摄像机跟随目标对象移动。该类包含以下属性：

1. `target`：目标对象，即要跟随的GameObject。
2. `mainCamera`：主摄像机，即要控制的摄像机。如果未提供，则默认为null。
3. `offset`：摄像机与目标对象之间的偏移量，用于调整摄像机的位置。

`CameraController`类包含一个名为`OnLateUpdate`的方法，该方法在每一帧的更新过程中被调用。`OnLateUpdate`方法接受一个`Vector2`类型的参数`rotationAngle`，用于表示摄像机绕Y轴和自身X轴的旋转角度。

在`OnLateUpdate`方法中，首先使用`Quaternion.AngleAxis`方法根据`rotationAngle.x`绕Y轴旋转`offset`向量。然后，使用`Quaternion.AngleAxis`方法根据`rotationAngle.y`绕摄像机自身的X轴旋转`offset`向量。

接下来，计算目标对象的位置加上偏移量后的位置，并将其设置为摄像机的目标位置。最后，使用`mainCamera.transform.LookAt`方法使摄像机朝向目标对象。

### PlayerOnCollisionMethod

包含一个构造函数，用于接收四个参数：`Transform`类型的`ballTransform`，`BallPhysical`类型的`ballPhysical`，`BallChange`类型的`ballChange`和`SubtitleManager`类型的`subtitleManager`。

类中定义了三个方法：`OnCollisionEnter`，`OnCollisionStay`和`OnCollisionExit`，用于处理碰撞事件。`OnTriggerEnter`，`OnTriggerStay`和`OnTriggerExit`方法用于处理触发器事件。

在`OnCollisionEnter`方法中，首先设置`ballPhysical`的`checkGroundRayLengthToCommonLength`属性为常量值。然后调用`subtitleManager`的`OnCollision`方法，传入碰撞对象的名称。

接下来，判断`ballChange`的`ballType`属性是否为`GravityBall`类型。如果是，则根据碰撞对象的标签进行相应的处理。如果标签为`Tag_CHANGEINGGRAVITY`，则将`ballPhysical`的`downVector`属性设置为相反方向；如果标签为`Tag_CHANGEINGGRAVITYINVERSE`，则将`ballPhysical`的`downVector`属性设置为相同方向。

在`OnCollisionStay`和`OnCollisionExit`方法中，没有进行任何操作。

在`OnTriggerEnter`方法中，首先调用`subtitleManager`的`OnTrigger`方法，传入触发器对象的名称。然后根据触发器对象的标签进行相应的处理。如果标签为`Tag_COLLECTABLE`，则触发一个名为`Ball_Touch_CollectableObj`的事件，并将触发器对象的名称作为参数传递。最后将触发器对象的激活状态设置为`false`。

在`OnTriggerStay`方法中，如果触发器对象的标签为`Tag_WINDZONE`，则将`ballPhysical`的`downVector`属性设置为触发器对象向上方向的单位向量，并添加一个大小为6的力。

在`OnTriggerExit`方法中，没有进行任何操作。

总之，这个类用于处理玩家在碰撞和触发器事件中的行为。

## X
### PlayerBallController.cs

用于控制游戏中的球形角色：

1. `PlayerBallController`的类，继承自`BallController`。`BallController`是一个基类，用于处理球形角色的基本行为。

2. 定义了一些私有成员变量，包括`mainCamera`（主摄像机）、`inputManager`（输入管理器）、`playerOnCollisionMethod`（碰撞方法）、`respawnGameObject`（重生游戏对象）和`cineMachineFreeLookList`（摄像机自由查看列表）。

3. 重写了`Start`方法，在`Start`方法中调用了`PlayerBallControllerStart`方法，用于初始化成员对象、添加玩家方法事件和设置更新方法列表。

4. 重写了`Update`方法，在`Update`方法中调用了`inputManager.OnUpdate()`，用于更新输入管理器的数据。然后遍历`updateMethodList`，调用每个更新方法。

5. 重写了`FixedUpdate`方法，在`FixedUpdate`方法中调用了`inputManager.OnFixedUpdate()`，用于更新输入管理器的数据。然后调用了`ballPhysical.OnFixedUpdate()`，用于更新球形角色的物理行为。最后调用了基类的`FixedUpdate`方法。

6. `SetBallJumpCoolingTime`的方法，用于设置球的跳跃冷却时间。

7. `PlayerBallControllerStart`的方法，用于初始化成员对象、添加玩家方法事件和设置更新方法列表。

8. `ReadAndSetBallConfig`的方法，用于读取并设置球的配置。

9. `ChangeBallType`的方法，用于切换球形角色的类型。

10. `InitMemberObject`的方法，用于初始化成员对象。

11. `SetUpdateMethodList`的方法，用于设置更新方法列表。

12. `AddPlayerMethodEvent`的方法，用于添加玩家方法事件。

13. `SetCollisionMethod`的方法，用于设置碰撞方法。

这段代码主要用于处理游戏中的球形角色，包括初始化、更新、跳跃、碰撞等行为。通过继承`BallController`基类，可以方便地扩展和修改球形角色的行为。

### PlayerOnCollisionMethod.cs

## BallController.cs

# Level
## SpecialInteraction
### Bottle
这段C#代码是Unity游戏开发环境中的一个脚本示例，它定义了一个名为Bottle的类，该类继承自MonoBehaviour，这意味着它可以附加到Unity场景中的游戏对象上，并允许你利用Unity的生命周期方法和组件系统。这个特定的脚本设计用于处理一个特殊的交互：当游戏中的一个球体（Ball）碰撞到这个瓶子（Bottle）时，如果球体的类型是石头球（RockBall），则执行一系列操作。下面是代码的详细解释：

if (!other.transform.CompareTag("Ball")) return;：首先检查碰撞的物体是否有标签“Ball”。如果不是，方法立即返回，不执行后续操作。
if(StaticData.Player.BallType!=BallTypeEnum.RockBall)return;：然后检查玩家的球的类型是否为RockBall。这里假设StaticData.Player是一个包含玩家信息的静态类，而BallType是其中的一个属性，类型为BallTypeEnum枚举。如果球的类型不是RockBall，方法也立即返回。
执行动作：

MusicManager.Instance.ChangeAndPlaySound("woodglassdefault",true);：如果上述条件都满足，则通过MusicManager的实例播放一个名为“woodglassdefault”的音效，可能模拟瓶子破碎的声音。true参数可能表示播放音效时应该立即停止当前播放的音效。
BrokenBottle.SetActive(true);：将BrokenBottle对象（破碎的瓶子视觉效果）激活，使其可见或可播放。
transform.gameObject.SetActive(false);：最后，将当前GameObject（即瓶子本身）设置为不活动，使其从场景中消失，模拟瓶子被打破的效果。

# Manager

## EventManager
- EventManager

用于管理游戏中的事件。事件管理类负责接收、处理和触发各种事件，使得游戏中的不同模块可以方便地相互通信。

首先，定义了一个`ChildThreadTriggerData`结构体，用于存储子线程触发的事件数据。

然后，定义了一个`EventManager`类，继承自`Singleton<EventManager>`。`Singleton<T>`是一个泛型单例类，用于创建一个全局唯一的`T`类型对象。

`EventManager`类中定义了一些字典，用于存储不同类型的事件处理函数。`_eventDict`用于存储普通事件处理函数，`_eventFailDict`用于存储失败事件处理函数，`_onceEventDict`用于存储一次性事件处理函数，`_triggerQueue`用于存储子线程触发的事件数据。

`EventManager`类中定义了一些方法，用于添加、删除、触发事件。这些方法分别对应了不同类型的事件处理函数，如`AddEvent`、`RemoveEvent`、`TriggerEvent`等。

`TriggerEvent`方法用于触发事件。它首先从`_eventDict`中获取对应事件类型的处理函数，然后遍历处理函数的调用列表，依次调用处理函数。如果在调用过程中发生异常，会将异常信息记录到日志中。同时，如果存在失败事件处理函数，会将失败事件处理函数的调用列表依次调用。

注意，`TriggerEvent`方法是线程安全的，可以在子线程中调用。

## InputManager
- InputManager

用于处理游戏中的输入操作。以下是代码的主要功能和实现原理：

1. `MoveData`的结构体，用于存储移动数据，包括水平方向和垂直方向的速度、是否按下空格键等。

2. `InputManager`的类，包含一个`KeyboardFunction`类型的成员变量`keyboardFunction`，用于处理键盘输入；一个布尔类型的成员变量`isMoveInputEffective`，用于判断移动输入是否有效；一个`List<Action>`类型的成员变量`eachFrameKeyMethod`，用于存储每帧需要执行的方法；一个常量`MethodMaxCount`，用于存储`eachFrameKeyMethod`的最大容量；一个`MoveData`类型的成员变量`moveData`，用于存储移动数据；一个浮点类型的成员变量`JumpCoolingTime`，用于存储跳跃冷却时间；一个`EventManager.Instance.AddEvent`方法，用于注册事件。

3. `OnUpdate`的方法，用于在更新时调用。

4. `OnFixedUpdate`的方法，用于在固定更新时调用。

5. `GetMoveData`的方法，用于获取移动数据。

6. `ChangeMoveInputEffective`的方法，用于切换移动输入的有效性。

7. `InitMoveData`的方法，用于初始化移动数据。

8. `SetMoveData`的方法，用于设置移动数据。

9. `GetHorizontalKeyData`的方法，用于获取水平方向的速度。

10. `GetVerticalKeyData`的方法，用于获取垂直方向的速度。

11. `HandlerEachFrameKeyMethod`的方法，用于处理每帧需要执行的方法。

12. `InputDebug`的方法，用于调试输入。

这个`InputManager`类主要用于处理游戏中的输入操作，包括键盘输入和移动输入。在更新时，它会检查是否有按键事件发生，如果有，则调用相应的方法。在固定更新时，它会更新移动数据，并检查是否有跳跃事件发生。

- KeyboardFunction

该类包含两个方法：`OpenChangeBallPanel`和`OnEscKeyDown`。这两个方法主要用于处理键盘输入，以实现特定的功能。

- 确保在调用这些方法之前已经正确地初始化了`UIManager`实例。
- 确保在调用这些方法时，对应的UI面板已经正确地注册到`UIManager`中。

## SaveManager
- SaveManager

用于管理游戏的存档。单例

`SaveManager`类中有一个名为`saveData`的私有字段，用于存储游戏的存档数据。`SaveManager`类中有一个名为`SAVE_FILE_PATH`的常量，用于存储存档文件的路径。

`SaveManager`类的构造函数中，首先调用`LoadSaveData()`方法加载存档数据，然后注册一个事件监听器，用于监听球碰到可收集对象的事件。当球碰到可收集对象时，会触发`BallTouchCollectableObj()`方法，将收集到的对象名称添加到`saveData`的`CollectedStarList`列表中，然后调用`WriteSaveData()`方法将存档数据写入文件。

`WriteSaveData()`方法将`saveData`对象转换为JSON字符串，并将其写入到持久化数据路径下的`saveData.json`文件中。

`LoadSaveData()`方法首先检查持久化数据路径下的`saveData.json`文件是否存在。如果存在，则从文件中读取JSON字符串，并将其转换为`SaveData`对象。如果不存在，则创建一个新的`SaveData`对象。

`GetCollectedStrList()`方法用于获取已经收集到的金球雕塑的名称列表。如果`saveData`不为空，则返回`saveData.CollectedStarList`，否则返回null。

总之，`SaveManager`类用于管理游戏的存档，包括加载、保存和获取收集到的金球雕塑的名称列表。

## X
### LoadManager.cs

继承自MonoSingleton类，用于管理场景加载和显示预制体（Prefab）的异步操作。LoadManager类包含三个方法：LoadAndShowPrefabAsync、LoadAudioClip和DestroyObj。

1. LoadAndShowPrefabAsync方法：

这个方法用于异步加载并显示一个预制体。它接受四个参数：objName（预制体的名称）、objPath（预制体的路径）、parentObjTransform（预制体的父对象变换）和callback（加载完成后执行的回调函数）。

方法内部使用Addressables.LoadAssetsAsync<GameObject>加载预制体，并将加载后的预制体实例化，设置其名称和父对象变换。最后，调用callback函数（如果提供了）并传入加载后的预制体。

2. LoadAudioClip方法：

这个方法用于异步加载一个音频剪辑（AudioClip）。它接受两个参数：objPath（音频剪辑的路径）和callback（加载完成后执行的回调函数）。

方法内部使用Addressables.LoadAssetsAsync<AudioClip>加载音频剪辑，并将加载后的音频剪辑传入callback函数（如果提供了）。

3. DestroyObj方法：

这个方法用于销毁一个游戏对象。它接受一个参数：obj（要销毁的游戏对象）。

方法内部使用Destroy函数销毁游戏对象。

总之，LoadManager类用于管理场景加载和显示预制体、音频剪辑等资源的异步操作，使得这些操作更加方便和灵活。

### MusicManager.cs

继承自MonoSingleton类，用于管理场景加载和显示预制体（Prefab）的异步操作。LoadManager类包含三个方法：LoadAndShowPrefabAsync、LoadAudioClip和DestroyObj。

1. LoadAndShowPrefabAsync方法：

这个方法用于异步加载并显示一个预制体。它接受四个参数：objName（预制体的名称）、objPath（预制体的路径）、parentObjTransform（预制体的父对象变换）和callback（加载完成后执行的回调函数）。

方法内部使用Addressables.LoadAssetsAsync<GameObject>加载预制体，并将加载后的预制体实例化，设置其名称和父对象变换。最后，调用callback函数（如果提供了）并传入加载后的预制体。

2. LoadAudioClip方法：

这个方法用于异步加载一个音频剪辑（AudioClip）。它接受两个参数：objPath（音频剪辑的路径）和callback（加载完成后执行的回调函数）。

方法内部使用Addressables.LoadAssetsAsync<AudioClip>加载音频剪辑，并将加载后的音频剪辑传入callback函数（如果提供了）。

3. DestroyObj方法：

这个方法用于销毁一个游戏对象。它接受一个参数：obj（要销毁的游戏对象）。

方法内部使用Destroy函数销毁游戏对象。

总之，LoadManager类用于管理场景加载和显示预制体、音频剪辑等资源的异步操作，使得这些操作更加方便和灵活。

### SubtitleManager.cs

用于管理游戏中字幕的显示。类中包含了两个方法：`OnCollision`和`OnTrigger`。

1. `OnCollision`方法：当球与某个物体发生碰撞时，从`StaticData.SubtitleConfigsDic`字典中移除该物体的配置信息，然后显示字幕面板。

2. `OnTrigger`方法：当球进入某个物体的触发区域时，从`StaticData.SubtitleConfigsDic`字典中获取该物体的配置信息，然后开始倒计时。当倒计时结束时，如果球仍然与该物体重叠，则显示字幕面板并从字典中移除该物体的配置信息。

`ShowSubtitlePanel`方法：检查字幕面板是否正在显示，如果正在显示，则隐藏该面板。然后显示新的字幕面板，并将当前字幕配置信息传递给该面板。

`StartTimeCountDown`方法：开始倒计时，当倒计时结束时，如果球仍然与该物体重叠，则显示字幕面板并从字典中移除该物体的配置信息。

`CheckSubtitlePanelShowing`方法：检查字幕面板是否正在显示，如果正在显示，则隐藏该面板。

总之，这段代码的主要作用是管理游戏中字幕的显示，当球与物体发生碰撞或进入触发区域时，根据配置信息显示相应的字幕。

### UIManager.cs

用于管理游戏中的UI面板。UIManager类包含一个构造函数，用于初始化UI根节点、Canvas和CanvasScaler等组件，以及一个用于存储面板的Dictionary。

ShowPanel方法用于显示一个面板，它接受一个泛型参数T，表示要显示的面板类型。通过调用LoadManager.Instance.LoadAndShowPrefabAsync方法异步加载面板的预制体，并在加载完成后将面板实例添加到_panelDic中。

HidePanel方法用于隐藏一个面板，它接受一个泛型参数T，表示要隐藏的面板类型。通过调用LoadManager.Destroy方法销毁面板的预制体，并从_panelDic中移除该面板。

HideAllPanel方法用于隐藏所有面板。遍历_panelDic中的所有面板，调用BeforeHide方法隐藏面板，并销毁面板的预制体。最后将_panelDic重置为空。

IsPanelShowing方法用于检查一个面板是否正在显示，它接受一个泛型参数T，表示要检查的面板类型。通过调用_panelDic.TryGetValue方法尝试获取面板实例，如果成功，则检查面板实例的activeSelf属性是否为true，以判断面板是否正在显示。

IsAnyPanelShowing方法用于检查是否有任何面板正在显示。遍历_panelDic中的所有面板，调用IsPanelShowing方法检查每个面板是否正在显示，如果有任何面板正在显示，则返回true。

# Panel

## BallChangePanel.cs

这段C#代码定义了一个名为BallChangePanel的类，它继承自PanelBase。这个类似乎是用于在Unity游戏中管理一个用于更改球类型（可能是游戏内角色或道具）的面板。下面是对这段代码的详细解释：

成员变量
private Transform ballTypeButtonGroup;：用于引用包含球类型选择按钮的UI元素（可能是一个按钮组）。

private Transform detailText;：用于引用显示详细信息的UI元素（如文本标签）。

方法
Init()：在面板初始化时调用。它使用TransformUtil.Find方法查找名为"BallTypeButtonGroup"的UI元素，并将其Transform赋值给ballTypeButtonGroup。

Bind()：在面板显示之前调用，用于绑定事件和设置UI元素。它调用SetChangeButton方法来处理球类型按钮的显示和点击事件，并查找名为"DetailText"的UI元素。

Show()：在面板显示时调用。它首先通过事件管理器（EventManager）触发两个事件（Switch_Camera和Change_Player_KeyInput_Effective），这些事件可能用于切换相机或更改玩家输入控制的有效性。然后，它调用SetProgressText方法来更新进度文本（可能显示收集到的星星数量或类似内容）。

BeforeHide()：在面板隐藏之前调用。它再次通过事件管理器触发与之前相同的两个事件，可能是为了恢复游戏状态到面板显示之前的状态。

SetChangeButton()：一个私有方法，用于设置球类型选择按钮的显示（如果未解锁则变灰）和点击事件。它遍历ballTypeButtonGroup下的所有子项（即按钮），根据是否解锁来更改按钮颜色，并为每个解锁的按钮添加点击事件。点击事件会触发OnChangeBallTypeButtonClick方法，该方法通过事件管理器发送BallType_Change事件，并包含被选中的球类型（BallTypeEnum），然后隐藏面板。

SetProgressText()：一个私有方法，用于更新进度文本（如收集到的星星数量）。它通过查找名为"ProgressText"的UI元素，并设置其TextMeshProUGUI组件的文本内容来实现。

CheckBallTypeIsUnlock(int typeIndex)：一个私有方法，用于检查指定索引的球类型是否已解锁。它比较玩家收集的星星数量和该球类型所需的星星数量。

注意事项
代码中使用了TransformUtil.Find方法来查找UI元素，这可能是一个自定义的工具方法，用于简化在Transform层次结构中查找子元素的过程。

EventManager.Instance是一个事件管理器的单例实例，用于在游戏的不同部分之间触发和监听事件。

StaticData.BallConfigData.BallConfigList和SaveManager.Instance.SaveData.CollectedStarList可能分别是存储球类型配置和玩家收集星星数量的静态数据或单例管理器的属性。

代码中使用了Lambda表达式来定义点击事件的回调方法，这是一种简洁的匿名函数写法。

在SetChangeButton方法中，OnClick方法的实现没有在代码片段中给出，但可以假设它负责为按钮添加点击事件监听器。同样，OnChangeBallTypeButtonClick方法中的BallTypeEnum类型也未在代码片段中定义，但可以推断它是一个枚举类型，用于表示不同的球类型。
## ComicPanel.cs

这段C#代码定义了一个名为ComicPanel的类，它继承自PanelBase类。ComicPanel类似于一个用于展示漫画的面板，它包含了加载、绑定点击事件以及展示和隐藏逻辑。下面是对这段代码的详细解释：

成员变量
private Transform ComicGroup;：这是一个Transform类型的私有变量，用于存储漫画组的引用。在Unity中，Transform组件用于表示游戏对象的位置、旋转和缩放。

private int ComicCount;：这是一个私有整数变量，用于存储漫画组中子对象的数量。

private int ComicIndex;：这是一个私有整数变量，用于追踪当前显示的漫画的索引。

方法
public override void Init()：这是PanelBase类中的Init方法的重写。在Init方法中，它首先定义了一个字符串comicGroupName，然后使用LoadManager.Instance.LoadAndShowPrefabAsync方法异步加载一个名为ComicGroup的预制件（Prefab）。加载完成后，使用TransformUtil.Find方法查找PanelObj.transform（可能是PanelBase类中的成员，代表面板对象的Transform）下名为comicGroupName的Transform组件，并设置给ComicGroup。然后，将ComicGroup的子对象数量赋值给ComicCount。

public override void Bind()：这也是PanelBase类中的Bind方法的重写。在Bind方法中，它调用了一个名为OnClick的方法（这个方法可能是在PanelBase类中定义的，用于绑定点击事件），将某个名为ClickArea的UI元素（可能是按钮或可点击区域）的点击事件绑定到OnComicPanelClick方法上。

public override void Show() 和 public override void BeforeHide()：这两个方法目前是空实现，但它们分别对应于面板的显示和隐藏前的逻辑。在实际应用中，你可能需要在这两个方法中添加特定的逻辑。

private void OnComicPanelClick()：这是一个私有方法，用于处理ClickArea的点击事件。当点击事件发生时，它首先检查ComicIndex是否等于ComicCount。如果是，则调用Hide方法（可能是PanelBase类中的方法，用于隐藏面板）并返回。如果不是，它将ComicGroup中索引为ComicIndex的子对象的gameObject设置为活动状态（即显示该漫画），并将ComicIndex加1以移动到下一个漫画。

总结
这个ComicPanel类通过异步加载漫画组预制件，并在点击事件发生时按顺序显示每个漫画。它使用了Unity的Transform组件来管理游戏对象的位置和层次结构，以及事件绑定和回调来响应用户交互。

## ExitPanel.cs

这段C#代码定义了一个名为ExitPanel的类，它继承自PanelBase类。ExitPanel类似乎用于处理一个包含退出、重置、设置和取消按钮的面板的逻辑。下面是对这段代码的详细解释：

成员变量
尽管在这段代码中没有直接声明成员变量，但我们可以推测PanelBase类可能包含了一些与面板相关的属性和方法，比如用于绑定点击事件的OnClick方法。

方法
public override void Bind()：这个方法重写了PanelBase类中的Bind方法。它用于绑定面板上不同按钮的点击事件到相应的处理函数上。这里绑定了四个按钮：ExitButton、ResetButton、SettingButton和CancelButton，分别对应OnExitButtonClick、OnResetButtonClick、OnSettingButtonClick和OnCancelButtonClick方法。

public override void Show()：这个方法重写了PanelBase类中的Show方法。当面板需要显示时，会调用这个方法。在这个方法中，它触发了两个事件：ClientEvent.Change_Player_KeyInput_Effective和ClientEvent.ChangeAllPlayer_CameraActivation，这两个事件可能用于改变玩家的键盘输入有效性和相机激活状态。然后，它调用了StaticMethod.SetTimeScale(0)来暂停游戏时间（假设StaticMethod是一个包含静态方法的类，而SetTimeScale是用于设置游戏时间缩放的方法）。

public override void BeforeHide()：这个方法重写了PanelBase类中的BeforeHide方法。当面板即将隐藏时，会调用这个方法。在这个方法中，它同样触发了之前提到的两个事件，并将游戏时间缩放设置回1，以恢复正常的游戏时间流逝。

private void OnExitButtonClick()：这个方法处理ExitButton的点击事件。在Unity编辑器中，它通过设置EditorApplication.isPlaying = false来停止播放场景。在非编辑器环境中（即构建的游戏中），它调用Application.Quit()来退出游戏。

private void OnResetButtonClick()：这个方法处理ResetButton的点击事件。它触发了ClientEvent.BallPos_Reset事件（可能用于重置球的位置），然后调用Hide()方法来隐藏当前面板。

private void OnSettingButtonClick()：这个方法处理SettingButton的点击事件。它调用UIManager.Instance.ShowPanel<SettingPanel>()来显示设置面板，并隐藏当前面板。

private void OnCancelButtonClick()：这个方法处理CancelButton的点击事件。它简单地调用Hide()方法来隐藏当前面板。

总结
ExitPanel类是一个用于处理包含退出、重置、设置和取消按钮的面板逻辑的类。它通过重写PanelBase类中的方法来实现面板的显示、隐藏以及按钮点击事件的处理。它还通过事件系统（EventManager）和静态方法（StaticMethod）来与其他游戏逻辑进行交互。
## HintChangePanel.cs

## SettingPanel.cs

这段C#代码定义了一个名为SettingPanel的类，它继承自PanelBase类，并用于处理游戏设置面板的逻辑。下面是对这段代码的详细解释：

成员变量
private Slider volumeSettingSlider;：一个Slider类型的私有变量，用于表示音量设置的滑块。

private Slider soundSettingSlider;：一个Slider类型的私有变量，用于表示音效设置的滑块。

方法
public override void Bind()：重写PanelBase类中的Bind方法。在这个方法中，首先通过OnClick方法（可能是PanelBase类中定义的方法，用于绑定按钮点击事件）将“SaveSettingButton”按钮的点击事件绑定到OnSaveSettingClick方法上。然后，使用TransformUtil.Find方法（可能是一个自定义的工具类方法，用于在Transform层级中查找具有指定名称的子Transform）找到名为“VolumeSettingSlider”和“SoundSettingSlider”的Slider组件，并将它们分别赋值给volumeSettingSlider和soundSettingSlider变量。接着，为这两个Slider组件的onValueChanged事件添加了监听器，分别调用SetMusicVolume和SetSoundVolume方法来处理音量和音效的变化。

public override void Show()：重写PanelBase类中的Show方法。在这个方法中，首先触发了两个事件（ClientEvent.Change_Player_KeyInput_Effective和ClientEvent.ChangeAllPlayer_CameraActivation），这些事件可能用于改变玩家的键盘输入有效性和相机激活状态。然后，从SaveManager.Instance.SaveData中获取保存的音量和音效值，并将它们分别设置为volumeSettingSlider和soundSettingSlider的当前值。最后，再次触发一个事件（ClientEvent.ChangeAllPlayer_CameraActivation）并调用StaticMethod.SetTimeScale(0)来暂停游戏时间。

public override void BeforeHide()：重写PanelBase类中的BeforeHide方法。在这个方法中，与Show方法类似，首先触发了两个事件（ClientEvent.Change_Player_KeyInput_Effective和ClientEvent.ChangeAllPlayer_CameraActivation），然后调用StaticMethod.SetTimeScale(1)来恢复正常的游戏时间流逝。

private void OnSaveSettingClick()：处理“SaveSettingButton”按钮点击事件的方法。在这个方法中，首先设置了SaveManager.Instance.SaveData.HasSetting为true，表示设置已被保存。然后，触发了一个名为ClientEvent.Setting_Save的事件，可能是用于通知其他部分游戏逻辑设置已保存。最后，调用Hide()方法（可能是PanelBase类中的方法，用于隐藏面板）。

private void SetMusicVolume(float volume)：处理音量滑块值变化的方法。在这个方法中，触发了一个名为ClientEvent.MusicVolume_Setting_Change的事件，并将音量值作为参数传递。这样，其他监听这个事件的部分就可以根据音量值的变化做出相应的处理。

private void SetSoundVolume(float volume)：处理音效滑块值变化的方法。与SetMusicVolume方法类似，它触发了一个名为ClientEvent.SoundVolume_Setting_Change的事件，并将音量值作为参数传递。

总结
SettingPanel类是一个用于处理游戏设置面板的类，它包含了音量和音效的滑块设置，以及保存设置的功能。通过与事件系统的交互，它能够将设置的变化通知给其他部分的游戏逻辑，从而实现全局设置的管理。
## SubtitlePanel.cs
- 类的成员变量

private Transform subtitleText;：一个Transform类型的私有变量，用于引用字幕文本组件的Transform。在Unity中，Transform组件包含了游戏对象的位置、旋转和缩放信息，并且每个游戏对象都有一个Transform组件。

public SingleSubtitleConfig CurSubtitleConfig;：一个公开的SingleSubtitleConfig类型的变量，用于存储当前字幕的配置信息。SingleSubtitleConfig可能是一个自定义的类，包含如字幕文本、显示时间、关闭时间等属性。

private int timeIndex;：一个私有的整型变量，用于存储添加到时间工具（TimeTool）中的事件索引。这个索引用于在需要时取消事件。

- 方法

public override void Init()：重写基类的Init方法。这个方法用于初始化SubtitlePanel。它设置了isCloseSelf（尽管这个变量没有在代码片段中显示，可能是在PanelBase中定义的）为true，表示这个面板可能在某个时刻需要自动关闭。它还设置了closeTime（同样可能在基类中定义）为当前字幕配置中的关闭时间，并调用AddCloseCall（这个方法没有在代码片段中定义，可能是基类的一部分或另一个工具类的方法）来安排关闭操作，并将返回的索引存储在timeIndex中。

public override void Bind()：重写基类的Bind方法。这个方法用于在面板显示之前绑定必要的组件。在这里，它使用TransformUtil.Find（这可能是一个自定义的工具方法，用于在Transform层次结构中查找子对象）来找到名为"SubtitleText"的Transform，并将其赋值给subtitleText变量。

public override void Show()：重写基类的Show方法。这个方法用于在面板显示时更新UI。在这里，它设置了字幕文本组件的文本为当前字幕配置中的文本。

public override void BeforeHide()：重写基类的BeforeHide方法。这个方法在面板隐藏之前被调用。在这里，它使用TimeTool.Instance.RemoveTimeEvent(timeIndex)来取消之前安排的关闭操作。TimeTool可能是一个管理时间事件的工具类，而RemoveTimeEvent方法用于根据事件索引取消事件。

- 总结

SubtitlePanel类是一个用于在Unity应用中显示和管理字幕的面板。它继承自PanelBase基类，并重写了几个关键方法以处理初始化、绑定、显示和隐藏前的逻辑。这个类使用了Unity的UI系统（通过TextMeshProUGUI组件）和可能的时间管理工具（如TimeTool）来实现其功能。

# StaticClass
# Tools

## Core

### ListNodeUtil.cs
### PanelBase.cs

这段代码定义了一个名为`PanelBase`的C#类，它是用于创建游戏面板的基本类：

1. 定义了一个名为`PanelObj`的公共属性，用于存储面板的GameObject。

2. 定义了一个名为`_onClicks`的私有序列化字典，用于存储面板中的点击事件。

3. 定义了一个名为`isCloseSelf`的私有布尔属性，用于表示面板是否自动关闭。

4. 定义了一个名为`closeTime`的私有浮点属性，用于表示面板关闭所需的时间。

5. 定义了一个名为`Init`的虚拟方法，用于初始化面板。

6. 定义了一个名为`Bind`的虚拟方法，用于绑定面板中的控件。

7. 定义了一个名为`Show`的虚拟方法，用于显示面板。

8. 定义了一个名为`BeforeHide`的虚拟方法，用于在关闭面板之前执行的操作。

9. 定义了一个名为`Hide`的私有方法，用于关闭面板。

10. 定义了一个名为`OnClick`的公共方法，用于为面板中的控件添加点击事件。

11. 定义了一个名为`AddCloseCall`的私有方法，用于在指定时间后自动关闭面板。

注意：这个类只是一个基本的面板类，实际项目中可能需要根据需求进行扩展和修改。

### Singleton.cs
### TransformUtil.csutil.cs

# X
## GameStartMono
单例，游戏启动时的一些配置和初始化操作

1. 定义了三个属性：`ballConfigScriptObjectMaker`、`subtitleConfigScriptObjectMaker`和`updateObjConfigScriptObjectMaker`，分别用于创建球配置、字幕配置和更新对象配置的脚本对象。

2. `isSkipComicPanel`的属性，用于判断是否跳过漫画界面。

3. 重写了`Awake()`方法，用于设置静态数据、加载玩家和环境。

4. `LoadPlayer()`的方法，用于加载玩家。

5. `LoadCamera()`的方法，用于加载相机。

6. `LoadEnvironment()`的方法，用于加载环境。

7. `SetStaticData()`的方法，用于设置配置文件信息。

# MiniGame(abandon)

<div STYLE="page-break-after: always;"></div>
